(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-member-order-evaluate"],{"067f":function(e,t,i){var a=i("c86c");t=a(!1),t.push([e.i,".img-list-item[data-v-ade234ee]{padding:%?30?% %?20?%}.img-list-item-gray[data-v-ade234ee]{background-color:#f7f7f7;overflow:hidden;padding:%?18?% %?20?%}.small-right[data-v-ade234ee]{width:%?520?%}.evaluate-content[data-v-ade234ee]{background-color:#fff;padding:%?20?% %?0?%}.evaluate-c-t[data-v-ade234ee]{width:100%;height:%?240?%}.evaluate-c-t uni-textarea[data-v-ade234ee]{width:100%;height:100%;font-size:%?26?%;padding:%?10?%}.evaluate-c-b[data-v-ade234ee]{overflow:hidden}.upload-img[data-v-ade234ee]{width:%?146?%;height:%?146?%;margin:%?14?%;text-align:center;color:#999;font-size:%?22?%;border:%?2?% solid #e1e1e1;\r\n\r\nborder-radius:%?4?%;display:inline-block;float:left;padding:%?24?% 0}.goods-img-item[data-v-ade234ee]{width:%?174?%;height:%?174?%;padding:%?14?%;float:left;position:relative}.goods-img-item[data-v-ade234ee]:nth-child(4n){margin-right:0}.goods-img-item uni-image[data-v-ade234ee]{width:100%;height:100%}.del[data-v-ade234ee]{width:%?30?%!important;height:%?30?%!important;position:absolute;right:0;top:0;z-index:999}.evaluate-num[data-v-ade234ee]{padding:%?20?% %?26?%;background-color:#fff;margin-top:%?20?%}.evaluate-num-t[data-v-ade234ee]{color:#333;font-size:%?28?%;margin-bottom:%?20?%}.button-bottom .btn[data-v-ade234ee]{width:100%}.evaluate-c-t[data-v-ade234ee]{padding-left:%?20?%;font-size:%?24?%}[data-v-ade234ee] .uni-input-input{font-size:%?26?%!important}.uni-input-placeholder[data-v-ade234ee]{font-size:%?24?%;color:#ccc}",""]),e.exports=t},"2cee":function(e,t,i){var a=i("067f");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("967d").default;n("dc4145ce",a,!0,{sourceMap:!1,shadowMode:!1})},"32b7":function(e,t,i){"use strict";i("6a54");var a=i("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("bf0f"),i("2797"),i("aa9c"),i("dd2b");var n=a(i("9291")),o=i("c305"),s={mixins:[o.goods],components:{uniRate:n.default},data:function(){return{orderId:0,info:{},images:[],score:[],textarea:[],isupload:[],rate:5,submitStatus:!1}},onLoad:function(e){this.orderId=e.order_id,this.orderId?this.orderInfo():this.$common.errorToShow("获取失败",(function(){uni.navigateBack({delta:1})}))},computed:{maxUploadImg:function(){return this.$store.state.config.image_max}},methods:{orderInfo:function(){var e=this,t={order_id:this.orderId};this.$api.orderDetail(t,(function(t){if(t.status&&t.data.pay_status>=2&&t.data.ship_status>=3&&t.data.confirm>=2&&1===t.data.is_comment){var i=t.data,a=[],n=[],o=[],s=[];i.items.forEach((function(e){a[e.id]=[],n[e.id]="",o[e.id]=!0,s[e.id]=5})),e.info=i,e.images=a,e.textarea=n,e.score=s,e.isupload=o}else e.$common.errorToShow("订单不存在或状态不可评价!")}))},uploadImg:function(e){var t=this;this.$api.uploadFiles((function(i){if(i.status){var a={url:i.data.url,id:i.data.image_id};t.images[e].push(a),t.$common.successToShow(i.msg)}else t.$common.errorToShow(i.msg)}))},removeImg:function(e,t){this.images[e].splice(t,1)},clickImg:function(e){uni.previewImage({urls:e.split()})},changeScore:function(e){this.score[e.id]=e.value},toEvaluate:function(){var e=this;this.submitStatus=!0;var t={};this.images.forEach((function(i,a){t[a]={images:i,score:e.score[a],textarea:e.textarea[a]}}));var i={order_id:this.orderId,items:t};this.$api.orderEvaluate(i,(function(t){t.status?e.$common.successToShow(t.msg,(function(e){var t=getCurrentPages(),i=t[t.length-2];void 0!==i&&"pages/member/order/orderlist"===i.route&&(i.isReload=!0);var a=t[t.length-3];void 0!==a&&"pages/member/order/orderlist"===a.route&&(a.isReload=!0),uni.navigateBack({delta:1})})):e.$common.errorToShow(t.msg)}),(function(t){e.submitStatus=!1}))}},watch:{images:{handler:function(){var e=this;this.images.forEach((function(t,i){e.isupload[i]=!(t.length>e.maxUploadImg)}))},deep:!0}}};t.default=s},"3cf9":function(e,t,i){"use strict";i.r(t);var a=i("73f7"),n=i("fc2a");for(var o in n)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("d483");var s=i("828b"),d=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"ade234ee",null,!1,a["a"],void 0);t["default"]=d.exports},"73f7":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a}));var a={uniRate:i("9291").default},n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"content-top"},[e._l(e.info.items,(function(t){return[t.name.indexOf("赠品")<0?i("v-uni-view",{key:t.id+"_0",staticClass:"img-list"},[i("v-uni-view",{staticClass:"img-list-item"},[i("v-uni-view",{staticClass:"img-list-item-gray"},[i("v-uni-image",{staticClass:"img-list-item-l small-img",attrs:{src:t.image_url,mode:"aspectFill"}}),i("v-uni-view",{staticClass:"img-list-item-r small-right",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.goodsDetail(t.goods_id)}}},[i("v-uni-view",{staticClass:"little-right-t"},[i("v-uni-view",{staticClass:"goods-name list-goods-name"},[e._v(e._s(t.name))])],1)],1)],1),i("v-uni-view",{staticClass:"evaluate-num"},[i("v-uni-view",{staticClass:"evaluate-num-t"},[e._v("商品评分")]),i("v-uni-view",{staticClass:"evaluate-num-b"},[i("uni-rate",{attrs:{size:"18",jid:t.id,value:e.score[t.id]},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.changeScore.apply(void 0,arguments)}}})],1)],1),i("v-uni-view",{staticClass:"evaluate-content"},[i("v-uni-view",{staticClass:"evaluate-c-t"},[i("v-uni-input",{attrs:{placeholder:"宝贝满足你的期待吗? 说说你的使用心得"},model:{value:e.textarea[t.id],callback:function(i){e.$set(e.textarea,t.id,i)},expression:"textarea[item.id]"}})],1),i("v-uni-view",{staticClass:"evaluate-c-b"},[e._l(e.images[t.id],(function(a,n){return e.images[t.id].length?i("v-uni-view",{key:n,staticClass:"goods-img-item"},[i("v-uni-image",{staticClass:"del",attrs:{src:"/static/image/del.png",mode:""},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.removeImg(t.id,n)}}}),i("v-uni-image",{attrs:{src:a.url,mode:""},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.clickImg(a.url)}}})],1):e._e()})),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.isupload[t.id],expression:"isupload[item.id]"}],staticClass:"upload-img"},[i("v-uni-image",{staticClass:"icon",attrs:{src:"/static/image/camera.png",mode:""},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.uploadImg(t.id)}}}),i("v-uni-view",{},[e._v("上传照片")])],1)],2)],1)],1)],1):e._e()]}))],2),i("v-uni-view",{staticClass:"button-bottom"},[i("v-uni-button",{staticClass:"btn btn-square btn-b",attrs:{"hover-class":"btn-hover",disabled:e.submitStatus,loading:e.submitStatus},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toEvaluate.apply(void 0,arguments)}}},[e._v("提交评论")])],1)],1)},o=[]},c305:function(e,t,i){"use strict";i("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.tools=t.subscription=t.orders=t.jumpBackPage=t.goods=t.goBack=t.clickUrl=t.checkLogin=void 0,i("dc8a"),i("5ef2"),i("5c47"),i("a1c1");var a={mounted:function(){},methods:{orderDetail:function(e){this.$common.navigateTo("/pages/member/order/orderdetail?order_id="+e)},toPay:function(e,t){t||(t=1),this.$common.navigateTo("/pages/goods/payment/index?order_id="+e+"&type="+t)},toEvaluate:function(e){this.$common.navigateTo("/pages/member/order/evaluate?order_id="+e)},showExpress:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=encodeURIComponent("code="+e+"&no="+t+"&add="+i);this.$common.navigateTo("/pages/member/order/express_delivery?params="+a)}}};t.orders=a;var n={mounted:function(){},methods:{goodsDetail:function(e){this.$common.navigateTo("/pages/goods/index/index?id="+e)},goodsList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="/pages/classify/index";Object.keys(e).length&&(t=this.$common.builderUrlParams(t,e)),this.$common.navigateTo(t)},groupDetail:function(e,t){this.$common.navigateTo("/pages/goods/index/group?id="+e+"&group_id="+t)},pintuanDetail:function(e,t){t?this.$common.navigateTo("/pages/goods/index/pintuan?id="+e+"&team_id="+t):this.$common.navigateTo("/pages/goods/index/pintuan?id="+e)}}};t.goods=n;var o={onBackPress:function(e){if("navigateBack"===e.from)return!1;var t=this.$store.state.redirectPage;return["/pages/cart/index/index","/pages/member/index/index"].indexOf(t)>-1?(this.$store.commit({type:"redirect",page:""}),uni.switchTab({url:"/pages/index/index"}),!0):void 0},backBtn:function(){var e=getCurrentPages();e.length>1?uni.navigateBack({delta:1}):uni.switchTab({url:"/pages/index/index"})}};t.goBack=o;var s={methods:{handleBack:function(){var e=this.$store.state.redirectPage;console.log(e),this.$store.commit({type:"redirect",page:""});["/pages/index/index","/pages/member/index/index"].indexOf(e)>-1?uni.switchTab({url:e}):e?uni.redirectTo({url:e}):uni.switchTab({url:"/pages/index/index"})}}};t.jumpBackPage=s;var d={methods:{checkIsLogin:function(){uni.showToast({title:"请先登录！",icon:"none",duration:800,success:function(e){setTimeout((function(){uni.hideToast(),uni.navigateTo({url:"/pages/login/login/index1"})}),200)}})}}};t.checkLogin=d;var r={methods:{setBarTitle:function(e){uni.setNavigationBarTitle({title:this.$t("".concat(e))})},copyData:function(e){var t=this;uni.setClipboardData({data:e,success:function(){t.$common.errorToShow("复制成功")}})},previewImage:function(e,t){uni.previewImage({current:t||0,urls:e,indicator:"default"})},savePoster:function(){this.downloadIamge(this.poster,"image")},downloadIamge:function(e,t){var i=new Image;i.setAttribute("crossorigin","anonymous"),i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;var a=e.getContext("2d");a.drawImage(i,0,0,i.width,i.height);var n=e.toDataURL("image/png"),o=document.createElement("a"),s=new MouseEvent("click");o.download=t||"photo",o.href=n,o.dispatchEvent(s)},i.src=e},downloadImageOfMp:function(e){}}};t.tools=r;var c={methods:{action:function(e,t){if(t)if(1==e)if(-1!=t.indexOf("http"))window.location.href=t;else{if("/pages/index/index"==t||"/pages/classify/classify"==t||"/pages/cart/index/index"==t||"/pages/me/index"==t)return void uni.switchTab({url:t});if(!(t.indexOf("/pages/coupon/coupon")>-1))return void navigateTo(t);var i=t.replace("/pages/coupon/coupon?id=","");this.receiveCoupon(i)}else 2==e?this.goodsDetail(t):3==e?this.$common.navigateTo("/pages/article/index?id="+t+"&id_type=1"):4==e?this.$common.navigateTo("/pages/article/list?cid="+t):5==e&&this.$common.navigateTo("/pages/form/detail/form?id="+t)},receiveCoupon:function(e){var t=this,i={promotion_id:e};this.$api.getCoupon(i,(function(e){e.status?t.$common.successToShow(e.msg):t.$common.errorToShow(e.msg)}))},goodsDetail:function(e){var t="/pages/goods/index/index?id="+e;navigateTo(t)}}};t.clickUrl=c;var u={data:function(){return{msgList:[{name:"下单通知",desc:"商城下单成功后通知我",func:"order",tmpl:"",status:!1},{name:"支付通知",desc:"订单支付后通知我",func:"pay",tmpl:"",status:!1},{name:"待付通知",desc:"未支付订单取消前通知我",func:"cancel",tmpl:"",status:!1},{name:"发货通知",desc:"订单发货后通知我",func:"ship",tmpl:"",status:!1},{name:"售后通知",desc:"订单售后结果通知我",func:"after_sale",tmpl:"",status:!1},{name:"退款通知",desc:"售后退款结果通知我",func:"refund",tmpl:"",status:!1}]}},methods:{getSubscriptionTmplIds:function(e){var t=this;this.$api.getSubscriptionTmplIds({type:e},(function(e){if(e.status){console.log("res.statue",e);for(var i=0;i<t.msgList.length;i++)e.data[t.msgList[i].func]&&(t.msgList[i].tmpl=e.data[t.msgList[i].func].template_id,""!=t.msgList[i].tmpl&&(t.msgList[i].status=!0))}}))},subAction:function(e){"function"==typeof e&&e()}}};t.subscription=u},d483:function(e,t,i){"use strict";var a=i("2cee"),n=i.n(a);n.a},fc2a:function(e,t,i){"use strict";i.r(t);var a=i("32b7"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a}}]);