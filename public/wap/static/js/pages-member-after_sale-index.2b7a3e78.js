(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-member-after_sale-index"],{"315f":function(t,e,i){"use strict";i.r(e);var s=i("6fc3"),a=i("5c17");for(var n in a)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(n);var d=i("828b"),r=Object(d["a"])(a["default"],s["b"],s["c"],!1,null,"8d8a7300",null,!1,s["a"],void 0);e["default"]=r.exports},"34bd":function(t,e,i){"use strict";i.r(e);var s=i("800e"),a=i.n(s);for(var n in s)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(n);e["default"]=a.a},"5c17":function(t,e,i){"use strict";i.r(e);var s=i("cbf9"),a=i.n(s);for(var n in s)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(n);e["default"]=a.a},"618d":function(t,e,i){var s=i("911ad");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var a=i("967d").default;a("323eff57",s,!0,{sourceMap:!1,shadowMode:!1})},"6fc3":function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-radio-group",{staticClass:"uni-list",on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.radioChange.apply(void 0,arguments)}}},t._l(t.type_list,(function(e,s){return i("v-uni-label",{key:s,staticClass:"uni-list-cell uni-list-cell-pd"},[i("v-uni-view",{staticClass:"invoice-type-icon"},[i("v-uni-radio",{staticClass:"a-radio",attrs:{id:e.name,value:e.value,checked:e.checked,disabled:e.disabled}})],1),i("v-uni-view",{staticClass:"invoice-type-c"},[i("v-uni-label",{staticClass:"label-2-text",attrs:{for:e.name}},[i("v-uni-text",[t._v(t._s(e.name))])],1)],1)],1)})),1)],1)},a=[]},"800e":function(t,e,i){"use strict";i("6a54");var s=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("bf0f"),i("2797"),i("c9b5"),i("ab80"),i("aa9c"),i("bd06"),i("dd2b"),i("5ef2"),i("c223"),i("64aa");var a=s(i("315f")),n={data:function(){return{type_list:[{value:"1",name:"未发货",checked:!0,disabled:!1},{value:"2",name:"已发货",checked:!1,disabled:!1}],order_id:"",items:[],item_ids:[],aftersale_type:1,refund:0,maxRefund:0,refund_show:0,images:[],reason:"",image_max:5,refund_input_noedit:!0,mode:"aspectFill",submitStatus:!1,checkedItems:[],isFlag:!0,cost_freight:0,orderInfo:{},buyNums:0,reshipNumsAll:0,reSult:{}}},components:{jhlable:a.default},computed:{isImage:function(){var t=this.image_max-this.images.length;return t>0}},methods:{radioChange:function(t){var e=this;this.type_list.forEach((function(i){i.value===t.target.value?(i.checked=!0,e.aftersale_type=t.target.value):i.checked=!1})),this.type_list[0].checked?this.refund_input_noedit=!0:this.refund_input_noedit=!1},getOrderInfo:function(){var t=this,e={order_id:this.order_id};this.$api.orderDetail(e,(function(e){if(e.status)if(t.orderInfo=e.data,1!=e.data.text_status&&6!=e.data.text_status&&7!=e.data.text_status){t.reSult=e.data;var i=t.type_list;2==e.data.text_status&&(i[1].disabled=!0);for(var s,a={},n=0,d=0,r=0;r<e.data.items.length;r++)e.data.items[r].nums>=e.data.items[r].reship_nums&&(a=e.data.items[r].nums-e.data.items[r].reship_nums),a>0&&(s=!0),e.data.items[r].id=e.data.items[r].id.toString(),e.data.items[r].returnNums=a,e.data.items[r].returnStatus=s,console.log("res.data.order_type",e.data.order_type),8===e.data.order_type?(e.data.items[r].checked=!0,t.checkedItems.push(e.data.items[r].id),t.item_ids.push({nums:e.data.items[r].returnNums,id:e.data.items[r].id})):e.data.items[r].checked=!1,e.data.items[r].returnNums>0?e.data.items[r].disabled=!1:e.data.items[r].disabled=!0,n+=e.data.items[r].nums,d+=e.data.items[r].reship_nums;t.buyNums=n,t.reshipNumsAll=d,t.items=e.data.items,8==e.data.order_type?t.refund=e.data.order_amount:t.refund=t.$common.moneySum(e.data.order_amount-e.data.refunded,0),t.maxRefund=t.$common.formatMoney(e.data.order_amount-e.data.refunded,2,""),t.cost_freight=e.data.cost_freight,t.refund_show=e.data.payed-e.data.refunded,t.type_list=i}else t.$common.errorToBack("订单不可以进行售后");else t.$common.errorToBack("没有找到此订单")}))},checkboxChange:function(t){var e=t.target.dataset.itemid,i=this.checkedItems.findIndex((function(t){return t==e}));i>=0?this.checkedItems.splice(i,1):this.checkedItems.push(e),this.getReturnData()},onFocus:function(t,e){t.returnNums="",-1==this.checkedItems.indexOf(t.id)&&this.checkedItems.push(t.id),this.items[e].checked=!0,this.getReturnData()},refundFocus:function(t){this.refund=""},updateNum:function(t,e){var i;i=this.items[e].nums-this.items[e].reship_nums,i<t.returnNums&&(this.isFlag=!1,this.items[e].returnNums=i,this.$common.errorToShow("您填写的数量不对！")),""==t.returnNums&&(this.items[e].returnNums=i),this.isFlag=!0,this.items[e].returnNums=t.returnNums,this.getReturnData()},getReturnData:function(){var t=0;this.item_ids=[];for(var e=0,i=0,s=0;s<this.checkedItems.length;s++)for(var a=this.checkedItems[s],n=0;n<this.items.length;n++)if(this.items[n].id==a&&this.items[n].nums>=this.items[n].reship_nums){if(t=this.items[n].nums-this.items[n].reship_nums,!(t>=this.items[n].returnNums))return void this.$common.errorToShow("您填写的数量不对！");t=this.items[n].returnNums,i+=t,this.item_ids=this.item_ids.concat({id:a,nums:t}),console.log("nums",t,this.items[n],t,this.items[n].nums-this.items[n].reship_nums),t==this.items[n].nums-this.items[n].reship_nums?e+=(100*this.items[n].ave_amount-this.items[n].reship_nums*this.items[n].ave_price*100)/100:e+=this.items[n].ave_price*t*100/100}i-=0;var d="";d=i+this.reshipNumsAll==this.buyNums?1==this.reSult.cost_freight_status?e.toFixed(2):(Number(e)+Number(this.cost_freight)).toFixed(2):e.toFixed(2),Number(d)>Number(this.maxRefund)?this.refund=this.maxRefund:this.refund=d},submit:function(t){var e=this;this.submitStatus=!0;for(var i=[],s=0;s<this.images.length;s++)i=i.concat(this.images[s].image_id);if(!this.isFlag)return this.$common.errorToShow("您填写的数量不对！"),this.submitStatus=!1,!1;console.log(this.item_ids);var a={order_id:this.order_id,type:this.aftersale_type,items:this.item_ids,images:i,refund:this.refund,reason:this.reason};8==this.orderInfo.order_type&&(a.order_type=8),this.$api.addAfterSales(a,(function(t){t.status?e.$common.successToShow("提交成功",(function(t){e.$common.navigateTo("/pages/member/order/orderdetail?order_id="+e.order_id)})):e.$common.errorToShow(t.msg)}),(function(t){e.submitStatus=!1}))},upImage:function(){var t=this,e=this.image_max-this.images.length;e>0&&this.$api.uploadImage(e,(function(e){e.status?(t.images.push(e.data),t.$common.successToShow(e.msg)):t.$common.errorToShow(e.msg)}))},delImage:function(t){for(var e=[],i=0;i<this.images.length;i++)this.images[i].image_id!=t.image_id&&e.push(this.images[i]);this.images=e},clickImg:function(t){uni.previewImage({urls:t.split()})}},onLoad:function(t){this.order_id=t.order_id,this.getOrderInfo(),this.getReturnData()}};e.default=n},"8c72":function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"cell-group margin-cell-group cell-header",staticStyle:{"margin-left":"0","padding-left":"20rpx"}},[t._v("请选择退货商品和数量")]),i("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"content-top"},[i("v-uni-view",{staticClass:"img-list cart-list"},t._l(t.items,(function(e,s){return i("v-uni-checkbox-group",{key:s,staticClass:"cart-checkbox",attrs:{"data-idx":s,"data-itemid":e.id},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.checkboxChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"cart-checkbox-item"},[i("v-uni-label",{staticClass:"uni-list-cell uni-list-cell-pd"},[i("v-uni-view",{staticClass:"cart-checkbox-c"},[e.disabled?i("v-uni-checkbox",{staticClass:"checkboxNo",attrs:{value:e.id,checked:e.checked,color:"#FF7159",disabled:e.disabled||8==t.orderInfo.order_type}}):i("v-uni-checkbox",{attrs:{value:e.id,checked:e.checked,disabled:8==t.orderInfo.order_type,color:"#FF7159"}})],1),i("v-uni-view",{staticClass:"img-list-item"},[i("v-uni-image",{staticClass:"img-list-item-l little-img have-none",attrs:{src:e.image_url,mode:"aspectFill"}}),i("v-uni-view",{staticClass:"img-list-item-r little-right"},[i("v-uni-view",{staticClass:"little-right-t"},[i("v-uni-view",{staticClass:"goods-name list-goods-name"},[t._v(t._s(e.name))])],1),e.addon?i("v-uni-view",{staticClass:"goods-item-c"},[i("v-uni-view",{staticClass:"goods-buy"},[i("v-uni-view",{staticClass:"goods-salesvolume mr5"},[t._v(t._s(e.addon))])],1)],1):t._e(),i("v-uni-view",{staticClass:"goods-item-c"},[i("v-uni-view",{staticClass:"goods-buy"},[i("v-uni-view",{staticClass:"goods-salesvolume mr5"},[t._v("购买数:"+t._s(e.nums))]),i("v-uni-view",{staticClass:"goods-salesvolume mr5"},[t._v("发货数量:"+t._s(e.sendnums))]),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:0!=e.reship_nums,expression:"item.reship_nums!=0"}],staticClass:"goods-salesvolume mr5"},[t._v("已退数量:"+t._s(e.reship_nums))]),e.disabled?t._e():i("v-uni-view",{staticClass:"goods-salesvolume"},[i("v-uni-label",[t._v("可退数：")]),i("v-uni-input",{ref:"input",refInFor:!0,staticClass:"inputStyle",attrs:{type:"number",disabled:8==t.orderInfo.order_type},on:{focus:function(i){arguments[0]=i=t.$handleEvent(i),t.onFocus(e,s)},blur:function(i){arguments[0]=i=t.$handleEvent(i),t.updateNum(e,s)},click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}},model:{value:e.returnNums,callback:function(i){t.$set(e,"returnNums",i)},expression:"item.returnNums"}})],1)],1)],1)],1)],1)],1)],1)],1)})),1),i("v-uni-view",{staticClass:"cell-group margin-cell-group"},[i("v-uni-view",{staticClass:"cell-item"},[i("v-uni-view",{staticClass:"cell-item-hd"},[i("v-uni-view",{staticClass:"cell-hd-title"},[t._v("是否发货")])],1),i("v-uni-view",{staticClass:"cell-item-ft"},[i("v-uni-view",{staticClass:"uni-form-item uni-column invoice-type"},[i("v-uni-radio-group",{staticClass:"uni-list",on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.radioChange.apply(void 0,arguments)}}},t._l(t.type_list,(function(e,s){return i("v-uni-label",{key:s,staticClass:"uni-list-cell uni-list-cell-pd"},[i("v-uni-view",{staticClass:"invoice-type-icon"},[e.disabled?i("v-uni-radio",{staticClass:"a-radio radioNo",attrs:{id:e.name,value:e.value,checked:e.checked,disabled:e.disabled}}):i("v-uni-radio",{staticClass:"a-radio ",attrs:{id:e.name,value:e.value,checked:e.checked,disabled:e.disabled}})],1),i("v-uni-view",{staticClass:"invoice-type-c"},[i("v-uni-label",{staticClass:"label-2-text",attrs:{for:e.name}},[i("v-uni-text",[t._v(t._s(e.name))])],1)],1)],1)})),1)],1)],1)],1),i("v-uni-view",{staticClass:"cell-item refund-price"},[i("v-uni-view",{staticClass:"cell-item-hd"},[i("v-uni-view",{staticClass:"cell-hd-title"},[t._v("退款金额")])],1),i("v-uni-view",{staticClass:"cell-item-ft"},[i("v-uni-input",{ref:"refund",staticClass:"cell-bd-input red-price",attrs:{type:"digit"},on:{focus:function(e){arguments[0]=e=t.$handleEvent(e),t.refundFocus.apply(void 0,arguments)}},model:{value:t.refund,callback:function(e){t.refund=e},expression:"refund"}})],1)],1),i("v-uni-view",{staticClass:"color-9 fsz24 refund-tip"},[t._v("可修改，最多￥"+t._s(t.maxRefund)+"，含发货邮费￥"+t._s(t.cost_freight))]),10==t.orderInfo.order_type?i("v-uni-view",{staticClass:"cell-item refund-price"},[i("v-uni-view",{staticClass:"cell-item-hd"},[i("v-uni-view",{staticClass:"cell-hd-title w200"},[t._v("可退积分")])],1),i("v-uni-view",{staticClass:"cell-item-ft color-9 fsz24 "},[t._v(t._s(t.orderInfo.point)+"积分")])],1):t._e(),10==t.orderInfo.order_type?i("v-uni-view",{staticClass:"color-9 fsz24 refund-tip"},[t._v("积分会在整单退款完毕后退回账户")]):t._e()],1),i("v-uni-view",{staticClass:"cell-group margin-cell-group"},[i("v-uni-view",{staticClass:"cell-item right-img"},[i("v-uni-view",{staticClass:"cell-item-hd"},[i("v-uni-view",{staticClass:"cell-hd-title"},[t._v("上传凭证")])],1)],1),i("v-uni-view",{},[i("v-uni-view",{staticClass:"evaluate-c-b"},[t._l(t.images,(function(e,s){return i("v-uni-view",{key:s,staticClass:"goods-img-item"},[i("v-uni-image",{staticClass:"del",attrs:{src:"/static/image/del.png",mode:""},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.delImage(e)}}}),i("v-uni-image",{attrs:{src:e.url,mode:""},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.clickImg(e.url)}}})],1)})),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.isImage,expression:"isImage"}],staticClass:"upload-img",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upImage.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"icon",attrs:{src:"/static/image/camera.png",mode:""}}),i("v-uni-view",{},[t._v("上传照片")])],1)],2)],1)],1),i("v-uni-view",{staticClass:"cell-group margin-cell-group"},[i("v-uni-view",{staticClass:"cell-item right-img"},[i("v-uni-view",{staticClass:"cell-item-hd"},[i("v-uni-view",{staticClass:"cell-hd-title"},[t._v("问题描述")])],1)],1),i("v-uni-view",{staticClass:"cell-textarea "},[i("v-uni-input",{attrs:{placeholder:"请您在此描述问题(最多200字)",maxlength:"200"},model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}})],1)],1)],1),i("v-uni-view",{staticClass:"button-bottom",staticStyle:{"z-index":"200"}},[i("v-uni-button",{staticClass:"btn btn-b btn-square",attrs:{formType:"submit",disabled:t.submitStatus,loading:t.submitStatus}},[t._v("提交")])],1)],1)],1)},a=[]},"911ad":function(t,e,i){var s=i("c86c");e=s(!1),e.push([t.i,".content-top[data-v-09d09eb0]{\n}.list-goods-name[data-v-09d09eb0]{font-size:%?26?%;width:100%!important}.cart-checkbox-item[data-v-09d09eb0]{position:relative}.invoice-type .uni-list-cell[data-v-09d09eb0]{display:inline-block;font-size:%?26?%;color:#333;position:relative;margin-left:%?50?%}.invoice-type .uni-list-cell>uni-view[data-v-09d09eb0]{display:inline-block}.invoice-type-icon[data-v-09d09eb0]{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.invoice-type-c[data-v-09d09eb0]{margin-left:%?50?%;line-height:2}.cell-item-ft .cell-bd-input[data-v-09d09eb0]{text-align:right;width:%?500?%;font-size:%?28?%}.right-img[data-v-09d09eb0]{border-bottom:0}.cell-textarea[data-v-09d09eb0]{padding:0 %?26?% %?20?%}.cell-textarea uni-textarea[data-v-09d09eb0]{width:100%;height:%?200?%;font-size:%?26?%;color:#333}.evaluate-c-b[data-v-09d09eb0]{overflow:hidden;padding:0 %?20?%}.upload-img[data-v-09d09eb0]{width:%?146?%;height:%?146?%;margin:%?14?%;text-align:center;color:#999;font-size:%?22?%;border:%?2?% solid #e1e1e1;border-radius:%?4?%;display:inline-block;float:left;padding:%?24?% 0}.goods-img-item[data-v-09d09eb0]{width:%?174?%;height:%?174?%;padding:%?14?%;float:left;position:relative}.goods-img-item[data-v-09d09eb0]:nth-child(4n){margin-right:0}.goods-img-item uni-image[data-v-09d09eb0]{width:100%;height:100%}.del[data-v-09d09eb0]{width:%?30?%!important;height:%?30?%!important;position:absolute;right:0;top:0;z-index:999}.cell-header[data-v-09d09eb0]{padding:10rpxpx 0;margin:0;margin-left:%?20?%;font-size:%?28?%;font-weight:550}.mr5[data-v-09d09eb0]{margin-right:%?10?%}.inputStyle[data-v-09d09eb0]{display:inline-block;border:%?2?% solid #ccc;height:%?13?%;line-height:%?13?%;width:%?60?%;text-align:center;font-size:%?24?%;vertical-align:middle;margin-bottom:%?8?%}\n.refund-price[data-v-09d09eb0]{border-bottom:none}.refund-tip[data-v-09d09eb0]{padding:0 %?26?% %?10?%;text-align:right}",""]),t.exports=e},c297:function(t,e,i){"use strict";var s=i("618d"),a=i.n(s);a.a},cbf9:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("bf0f"),i("2797");e.default={data:function(){return{type_list:[{value:"1",name:"仅退款",checked:!0,disabled:!1},{value:"2",name:"退货退款",checked:!1,disabled:!1}]}},methods:{radioChange:function(t){var e=this;this.type_list.forEach((function(i){i.value===t.target.value?(i.checked=!0,e.aftersale_type=t.target.value):i.checked=!1})),this.type_list[0].checked?this.refund_input_noedit=!0:this.refund_input_noedit=!1}}}},f349:function(t,e,i){"use strict";i.r(e);var s=i("8c72"),a=i("34bd");for(var n in a)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(n);i("c297");var d=i("828b"),r=Object(d["a"])(a["default"],s["b"],s["c"],!1,null,"09d09eb0",null,!1,s["a"],void 0);e["default"]=r.exports}}]);